渗透过程中信息收集找到一堆IP资产，很多都存在HTTP服务，但打开后返回状态码403、404或500等。探测其它信息也没有任何反应，可以通过hosts碰撞获取更多内网域名信息。

## 什么是hosts碰撞

以`Nginx`为例，在映射外网服务时会配置很多映射关系，`Nginx`将外网经过的HTTP流量代理到不同的内网服务器上，以达到1个外网地址映射N个域名目的。由于业务变更或内外网公用`Nginx`等原因，域名虽未映射在外网，但在Nginx配置里确实存在对应内网映射关系，这就是Hosts碰撞问题产生原理。

![Nginx hosts](https://res.vulab.io/img/b8398be030cc7ee421f6edb3c0966546.png)